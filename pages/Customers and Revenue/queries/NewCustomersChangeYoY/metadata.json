{
  "gitSyncId": "63e8d02d1e242279f5911ffe_63e8e51eb891ad2a97f2073b",
  "id": "Customers and Revenue_NewCustomersChangeYoY",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT\n    tm.month_start                               AS x,          -- month label\n    tm.cnt                                       AS z,          -- this-year count\n    ROUND(\n        (tm.cnt - ly.cnt) / ly.cnt * 100 , 1\n    )                                            AS y           -- YoY %\nFROM (\n\n    /* this-year (and prior) counts, trimmed to \"day-of-month â‰¤ today\"\n       only for months whose number equals MONTH(CURDATE())           */\n    SELECT\n        DATE_FORMAT(date_created, '%Y-%m-01')    AS month_start,\n        COUNT(*)                                 AS cnt\n    FROM wp_edd_customers\n    WHERE\n          date_created >= '1970-01-01'\n      AND (\n              MONTH(date_created) <> MONTH(CURDATE())\n           OR DAY(date_created)  <= DAY(CURDATE())\n          )\n      /* optional filters that mimic EDD_Customer_Query\n         AND purchase_count > 0\n         AND email IS NOT NULL AND email <> ''\n      */\n    GROUP BY month_start\n) AS tm\n\nLEFT JOIN (\n\n    /* same counts, used for \"last year\" comparison               */\n    SELECT\n        DATE_FORMAT(date_created, '%Y-%m-01')    AS month_start,\n        COUNT(*)                                 AS cnt\n    FROM wp_edd_customers\n    WHERE\n          date_created >= '1970-01-01'\n      AND (\n              MONTH(date_created) <> MONTH(CURDATE())\n           OR DAY(date_created)  <= DAY(CURDATE())\n          )\n    GROUP BY month_start\n) AS ly\n  ON ly.month_start = DATE_FORMAT(\n         DATE_SUB(tm.month_start, INTERVAL 1 YEAR),\n         '%Y-%m-01'\n       )\n\nORDER BY tm.month_start;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": false
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Easy Digital Downloads",
      "isAutoGenerated": false,
      "name": "Easy Digital Downloads",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [],
    "name": "NewCustomersChangeYoY",
    "pageId": "Customers and Revenue",
    "runBehaviour": "ON_PAGE_LOAD",
    "userSetOnLoad": false
  }
}